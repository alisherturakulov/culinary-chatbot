<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name = "viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="./chatbot-styles.css">
    </head>
    <body>
        <div class="chatBotBox">
            <!--<input type="checkbox" class="chatBotTab" name="chatBotTab">
                Open Chatbot-->
            <div class="chatBotTab">
                Open Chatbot
            </div>
            <div class="chatBotMessageBox">
                <p class="botMessage">
                    Hello, ask me any questions about Culinary Argan Oil!
                </p>
                <!-- class= "userMessage" for user-->
            </div>
            <div class="chatBotInputBox">
                <input type="text" name="chatBotInput" class="chatBotInput" placeholder="Example: what are the benefits of Argan Oil?">

                </input>
                <button class="chatBotButton" type="button" on onclick="postUserMessage()">
                    Enter
                </button>
            </div>
        </div>
        <div>
            <h1>
                Placeholder Heading; tis would be a webpage
            </h1>
            <p>
                click on "Open Chatbot" to bring the chat UI into view
            </p>
        </div>
        <script class="chatBoxMoveScript" async="false" defer>
            let chatBoxTab = document.querySelector(".chatBotTab");
            chatBoxTab.addEventListener("click", toggleChatBox);
            const clickEvent = new Event("click");
            chatBoxTab.dispatchEvent(clickEvent);
          

            //function definitions
            /**
             * adds/removes the openedChatBox class from styles to make the chatBox
             * visible or not
             */
            function toggleChatBox(){
                const chatBox = document.querySelector(".chatBotBox");
                chatBox.classList.toggle("openChatBox");
                const tab = document.querySelector(".chatBotTab");
                let tabText = tab.textContent;

                if(tabText.trim().includes("Open")){
                    tabText = "Close Chatbot";
                }else{
                    tabText = "Open Chatbot";
                }
                tab.textContent = tabText;
                //console.log("openedChatBox");
            }

            /**
             * adds the question to the messageList and sends a request to the backend
             * @see addUserMessage
            */
            function postUserMessage(){
                const userInputField = document.querySelector(".chatBotInput");
                const questionText = userInputField.value;
                console.log(questionText + "passed");
                addUserMessage(questionText);
                //next send a request to the backend script
                
            }

            /**
             * adds a p element as a user message to the chat
             * param {string} questionText
            */
            function addUserMessage(questionText){
                const userMessage= document.createElement("p");
                userMessage.classList.add("userMessage");
                userMessage.textContent = questionText;
                console.log(userMessage.textContent);
                const messageList = document.querySelector(".chatBotMessageBox");
                messageList.lastChild.after(userMessage);
                console.log(messageList.lastChild.textContent);
            }
        </script>
    </body>
</html>
